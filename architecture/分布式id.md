https://zhuanlan.zhihu.com/p/107939861

分库分表后需要唯一id来标识一条数据

1. uuid

优点：简单

缺点：无序 数据频繁变动影响性能

2. redis

缺点是如果redis挂掉可能会导致id重复

例如rdb定时快照持久化，如果未持久化期间，redis挂掉，重新起服务，会生成重复id

aof倒是不会，但会导致恢复时间长

rdf+aof混合持久化

3. snowflake算法

趋势递增 全局唯一

使用41bit作为毫秒数，10bit作为机器的ID（5个bit是数据中心，5个bit的机器ID），12bit作为毫秒内的流水号（意味着每个节点在每毫秒可以产生 4096 个 ID），最后还有一个符号位，永远是0。

缺点是依赖于机器时钟，如果机器时间回拨，就会生成重复id

存在并发限制 毫秒

4. 百度开源基于snowflake算法

利用未来时间解决这个限制
